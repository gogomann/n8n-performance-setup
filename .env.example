# ======================================================
# n8n High-Performance Setup - Umgebungsvariablen
# ======================================================
#
# WICHTIG: 
# 1. Kopiere diese Datei nach ".env"
# 2. Ersetze alle Platzhalter mit deinen Werten
# 3. Committe NIEMALS die .env Datei ins Repository!
#
# ======================================================

# ======================================================
# PostgreSQL Konfiguration
# ======================================================

# Datenbank-User (Standard: n8n)
POSTGRES_USER=n8n

# Datenbank-Passwort
# WICHTIG: Verwende ein STARKES Passwort!
# Generiere mit: openssl rand -base64 32
POSTGRES_PASSWORD=your-super-secure-postgres-password-here

# Datenbank-Name (Standard: n8n)
POSTGRES_DB=n8n

# Externer Port für PostgreSQL (optional, nur bei Bedarf)
# Standard: 5432
POSTGRES_EXTERNAL_PORT=5432

# Pfad zum PostgreSQL Data Directory
# Beispiel: /srv/n8n/postgres oder ./data/postgres
POSTGRES_DATA_PATH=./data/postgres

# ======================================================
# Redis Konfiguration
# ======================================================

# Maximaler RAM für Redis
# Empfehlung: 256mb für kleine Setups, 512mb-1gb für größere
REDIS_MAX_MEMORY=256mb

# Optional: Redis-Passwort (wenn Redis Auth aktiviert)
# REDIS_PASSWORD=your-redis-password

# Pfad zum Redis Data Directory
REDIS_DATA_PATH=./data/redis

# ======================================================
# n8n Basis-Konfiguration
# ======================================================

# Domain unter der n8n erreichbar ist
# Beispiele: n8n.example.com, localhost, 192.168.1.100
N8N_HOST=localhost

# Protokoll (http oder https)
# WICHTIG: Bei HTTPS auch N8N_SECURE_COOKIE auf true setzen!
N8N_PROTOCOL=http

# Interner n8n Port (normalerweise nicht ändern)
N8N_PORT=5678

# Externer n8n Port (Port auf dem Host-System)
N8N_EXTERNAL_PORT=5678

# Webhook-URL (muss von außen erreichbar sein!)
# Format: https://your-domain.com/ oder http://localhost:5678/
WEBHOOK_URL=http://localhost:5678/

# Secure Cookie (nur bei HTTPS auf true setzen)
N8N_SECURE_COOKIE=false

# Pfad zum n8n Data Directory
# Enthält: Credentials, Workflows, Binary Data, etc.
N8N_DATA_PATH=./data/n8n

# ======================================================
# n8n Verschlüsselung
# ======================================================

# Encryption Key für Credentials
# WICHTIG: 
# - Muss mindestens 32 Zeichen lang sein
# - NIEMALS ändern nach dem ersten Start!
# - Muss für Main + alle Worker IDENTISCH sein!
# - Bei Verlust sind alle Credentials unbrauchbar!
#
# Generiere mit: openssl rand -base64 32
N8N_ENCRYPTION_KEY=your-super-secret-encryption-key-minimum-32-characters

# ======================================================
# n8n Performance & Logging
# ======================================================

# Log Level (debug, info, warn, error)
# Empfehlung: "info" für Produktion, "debug" nur bei Problemen
N8N_LOG_LEVEL=info

# Prometheus Metrics aktivieren
N8N_METRICS=true

# ======================================================
# Worker Konfiguration
# ======================================================

# Concurrency pro Worker
# = Anzahl gleichzeitig ausgeführter Workflows pro Worker
# 
# Empfehlung:
# - CPU-intensive Workflows: Anzahl CPU-Cores
# - I/O-intensive Workflows: CPU-Cores * 2-3
# - Gemischt: CPU-Cores * 1.5
#
# Beispiel: 4 CPU-Cores → 5-6 Concurrency
WORKER_CONCURRENCY=5

# ======================================================
# Execution Settings
# ======================================================

# Timeout für einzelne Workflows (Millisekunden)
# Standard: 300000 = 5 Minuten
EXECUTIONS_TIMEOUT=300000

# Maximales Timeout (Millisekunden)
# Standard: 3600000 = 1 Stunde
EXECUTIONS_TIMEOUT_MAX=3600000

# ======================================================
# Data Retention
# ======================================================

# Automatisches Löschen alter Ausführungen
EXECUTIONS_DATA_PRUNE=true

# Alter in Stunden (336 = 14 Tage)
# Empfehlung: 168 (7 Tage) bis 720 (30 Tage)
EXECUTIONS_DATA_MAX_AGE=336

# ======================================================
# User & Group IDs (für Berechtigungen)
# ======================================================

# User ID (Standard: 1000)
# Finde mit: id -u
PUID=1000

# Group ID (Standard: 1000)
# Finde mit: id -g
PGID=1000

# ======================================================
# Optional: Erweiterte Einstellungen
# ======================================================

# Timezone (optional)
# TZ=Europe/Berlin

# Basic Auth (optional, für zusätzlichen Schutz)
# N8N_BASIC_AUTH_ACTIVE=true
# N8N_BASIC_AUTH_USER=admin
# N8N_BASIC_AUTH_PASSWORD=secure-password

# Custom CA Certificates (optional)
# NODE_EXTRA_CA_CERTS=/path/to/ca-certificates.crt

# Proxy Settings (optional)
# HTTP_PROXY=http://proxy.example.com:8080
# HTTPS_PROXY=http://proxy.example.com:8080
# NO_PROXY=localhost,127.0.0.1

# ======================================================
# Notizen
# ======================================================
#
# Nach dem Bearbeiten dieser Datei:
# 1. Speichern als ".env" (ohne .example)
# 2. Berechtigungen setzen: chmod 600 .env
# 3. Container starten: docker-compose up -d
# 4. Logs prüfen: docker-compose logs -f
#
# Bei Problemen:
# - docker-compose logs n8n-main
# - docker-compose logs n8n-worker-1
# - docker-compose exec postgres psql -U n8n
# - docker-compose exec redis redis-cli
#
# ======================================================